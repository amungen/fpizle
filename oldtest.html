<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uçak Kazası Raporu</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">

</head>
<body>
    <div class="container mt-5">
        <h4 class="text-center">Program Seçiniz</h4>
        <div class="row justify-content-center">
            <!-- Program, Season, and Episode selectors in a row -->
            <div class="col-md-4">
                <label for="programSelect" class="form-label">Choose Program:</label>
                <select id="programSelect" class="form-select" onchange="updateSeasons()">
                    <option value="">Select Program</option>
                    <!-- Options will be populated by JS -->
                </select>
            </div>
            <div class="col-md-4">
                <label for="seasonSelect" class="form-label">Choose Season:</label>
                <select id="seasonSelect" class="form-select" onchange="updateEpisodes()">
                    <option value="">Select Season</option>
                    <!-- Options will be populated by JS -->
                </select>
            </div>
            <div class="col-md-4">
                <label for="episodeSelect" class="form-label">Choose Episode:</label>
                <select id="episodeSelect" class="form-select" onchange="setEpisode()">
                    <option value="">Select Episode</option>
                    <!-- Options will be populated by JS -->
                </select>
            </div>
        </div>

        <div class="row justify-content-center mt-4">
            <div class="col-md-8">
                <div id="iframeContainer" class="text-center">
                    <!-- iframe will be displayed here -->
                </div>
            </div>
        </div>
    </div>

    <script>
       const data = null;
	   fetch('data.json')
    .then(response => response.json())
    .then(jsonData => {
        data = jsonData; // JSON verisini 'data' değişkenine atıyoruz
    })
    .catch(error => console.error("JSON verisi okunamadı:", error));


        let selectedProgram = "";
        let selectedSeason = "";
        let selectedEpisode = "";

      function populateSelects() {
    const programSelect = document.getElementById('programSelect');
    const seasonSelect = document.getElementById('seasonSelect');
    const episodeSelect = document.getElementById('episodeSelect');

    const programs = [...new Set(data.map(item => item.Program))];
    programs.sort(); // Programları alfabetik sıralıyoruz
    programs.forEach(program => {
        let option = document.createElement('option');
        option.value = program;
        option.textContent = program;
        programSelect.appendChild(option);
    });
}


       function updateSeasons() {
    selectedProgram = document.getElementById('programSelect').value;
    const seasonSelect = document.getElementById('seasonSelect');
    seasonSelect.innerHTML = '<option value="">Select Season</option>'; // Reset seasons

    if (selectedProgram) {
        const seasons = [...new Set(data.filter(item => item.Program === selectedProgram).map(item => item.Season))];
        seasons.sort(); // Sezonları alfabetik sıralıyoruz
        seasons.forEach(season => {
            let option = document.createElement('option');
            option.value = season;
            option.textContent = season;
            seasonSelect.appendChild(option);
        });
    }
    updateEpisodes(); // Reset episodes when program changes
}


      function updateEpisodes() {
    selectedSeason = document.getElementById('seasonSelect').value;
    const episodeSelect = document.getElementById('episodeSelect');
    episodeSelect.innerHTML = '<option value="">Select Episode</option>'; // Reset episodes

    if (selectedProgram && selectedSeason) {
        const episodes = [...new Set(data.filter(item => item.Program === selectedProgram && item.Season === selectedSeason).map(item => item.Episode))];
        episodes.sort(); // Bölümleri alfabetik sıralıyoruz
        episodes.forEach(episode => {
            let option = document.createElement('option');
            option.value = episode;
            option.textContent = episode;
            episodeSelect.appendChild(option);
        });
    }
}


        function setEpisode() {
            selectedEpisode = document.getElementById('episodeSelect').value;
            displayIframe(); // Call the display function when episode is selected
        }

  function displayIframe() {
    const program = selectedProgram;
    const season = selectedSeason;
    const episode = selectedEpisode;
    const iframeContainer = document.getElementById('iframeContainer');

    const selectedData = data.find(item => item.Program === program && item.Season === season && item.Episode === episode);
    
    if (selectedData && program && season && episode) {
        // Get screen width and height
        const screenWidth = window.innerWidth;
        const screenHeight = window.innerHeight;

        // Adjust iframe size based on screen dimensions
        const iframeWidth = screenWidth * 1; // 100% of screen width
        const iframeHeight = screenHeight * 0.5; // 50% of screen height (optional, can be adjusted)

const iframedata2 = selectedData.Iframe;

        // Dynamically adjust iframe to 100% width and calculated height
        const iframeHTML = selectedData.Iframe.replace(/width="\d+"/, `width="${iframeWidth}"`).replace(/height="\d+"/, `height="${iframeHeight}"`);

        // Create the iframe container with episode name and iframe
        iframeContainer.innerHTML = "<h3>" + selectedData.Episode_Name + "</h3>" + iframeHTML;
        
        // Extract Facebook video ID (this is assuming you can extract the ID from the iframe src URL)
        try {
const startIdx = iframedata2.indexOf('videos') + 9; // '/videos%2F' kısmının sonrasını almak için
const endIdx = iframedata2.indexOf('%2F&show_text'); // '%2F&show_text' kısmının başladığı yer

// Eğer start ve end index'leri bulunduysa
if (startIdx !== -1 && endIdx !== -1) {
    const videoId = iframedata2.substring(startIdx, endIdx); // ID'yi al
    console.log("Video ID:", videoId);

                // Create a "Go to Video" button that links to the Facebook video
const buttonHTML = "<br><button class='btn btn-primary' onclick='window.open(\"https://www.facebook.com/ferhat.polaterce.9/videos/" + videoId + "\", \"_blank\")'>" +
                    "<i class='fab fa-facebook-f'></i> Videoyu Facebook'da İzle" +
                  "</button>";
                iframeContainer.innerHTML += buttonHTML;  // Append button below iframe
				} else {
    console.error("Video ID bulunamadı.");
}
        } catch (error) {
            console.error("An error occurred while extracting video ID: ", error);
        }
    } else {
        iframeContainer.innerHTML = ''; // Clear iframe if conditions aren't met
    }
}




        populateSelects();
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
